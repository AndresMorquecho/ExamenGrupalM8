datasource db {
  provider="mysql"
  url = env("DATABASE_URL")
}

generator client{
  provider="prisma-client-js"
}


model Usuario {
  id         Int        @id @default(autoincrement())
  email      String     @unique
  password   String
  rol        Rol        @default(User)
  prestamos  Prestamo[]    
  historial  Historial[]   
}

enum Rol {
  Admin
  User
}


model Libro {
  id          Int        @id @default(autoincrement())
  titulo      String
  autor       String
  descripcion String?
  disponible  Boolean    @default(true)
  prestamos   Prestamo[]    
  historial   Historial[]   
}

model Prestamo {
  id               Int       @id @default(autoincrement())
  usuarioId        Int
  libroId          Int
  fechaPrestamo    DateTime  @default(now())
  fechaDevolucion  DateTime?

  usuario          Usuario   @relation(fields: [usuarioId], references: [id])
  libro            Libro     @relation(fields: [libroId], references: [id])
}

model Historial {
  id               Int       @id @default(autoincrement())
  usuarioId        Int
  libroId          Int
  fechaPrestamo    DateTime  @default(now())
  fechaDevolucion  DateTime?

  usuario          Usuario   @relation(fields: [usuarioId], references: [id])
  libro            Libro     @relation(fields: [libroId], references: [id])
}

model TokenRevocado{
  id Int @id @default(autoincrement())
  token String @db.VarChar(255) @unique
  createAt DateTime @default(now())
}